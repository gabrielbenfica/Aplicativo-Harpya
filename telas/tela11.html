<form id="addressForm" autocomplete="off">
    <span class="error-message" id="errorMsg" style="color:red;"></span>

    <label for="cep">CEP:</label>
    <input type="text" id="cep" name="cep" maxlength="8" required placeholder="Digite o CEP (8 dígitos)">

    <label for="rua">Rua:</label>
    <input type="text" id="rua" name="rua" readonly>

    <label for="numero">Número:</label>
    <input type="text" id="numero" name="numero" placeholder="Digite o número">

    <label for="bairro">Bairro:</label>
    <input type="text" id="bairro" name="bairro" readonly>

    <label for="cidade">Cidade:</label>
    <input type="text" id="cidade" name="cidade" readonly>

    <label for="uf">Estado:</label>
    <input type="text" id="uf" name="uf" readonly>

    <button type="submit" id="saveBtn" style="background-color:#4caf50;color:white;">Salvar</button>
    <button type="button" id="clearBtn">Limpar</button>
</form>

<script>
    document.getElementById('cep').addEventListener('blur', function () {
        const cep = this.value.replace(/\D/g, '');

        if (cep.length !== 8) {
            mostraErro("CEP inválido. Deve conter 8 dígitos.");
            limpaCamposEndereco();
            return;
        }

        fetch(`https://viacep.com.br/ws/${cep}/json/`)
            .then(resposta => resposta.json())
            .then(dados => {
                if (dados.erro) {
                    mostraErro("CEP não encontrado.");
                    limpaCamposEndereco();
                } else {
                    document.getElementById('rua').value = dados.logradouro;
                    document.getElementById('bairro').value = dados.bairro;
                    document.getElementById('cidade').value = dados.localidade;
                    document.getElementById('uf').value = dados.uf;
                    limpaErro();
                }
            })
            .catch(() => {
                mostraErro("Erro ao buscar o CEP.");
                limpaCamposEndereco();
            });
    });

    function mostraErro(mensagem) {
        document.getElementById('errorMsg').textContent = mensagem;
    }

    function limpaErro() {
        document.getElementById('errorMsg').textContent = '';
    }

    function limpaCamposEndereco() {
        document.getElementById('rua').value = '';
        document.getElementById('bairro').value = '';
        document.getElementById('cidade').value = '';
        document.getElementById('uf').value = '';
    }

    document.getElementById('clearBtn').addEventListener('click', function () {
        document.getElementById('addressForm').reset();
        limpaCamposEndereco();
        limpaErro();
    });

    document.getElementById('addressForm').addEventListener('submit', function (e) {
        e.preventDefault();

        const dados = {
            cep: document.getElementById('cep').value,
            rua: document.getElementById('rua').value,
            numero: document.getElementById('numero').value,
            bairro: document.getElementById('bairro').value,
            cidade: document.getElementById('cidade').value,
            uf: document.getElementById('uf').value
        };

        alert(
            `Dados salvos:\n` +
            `CEP: ${dados.cep}\n` +
            `Rua: ${dados.rua}\n` +
            `Número: ${dados.numero}\n` +
            `Bairro: ${dados.bairro}\n` +
            `Cidade: ${dados.cidade}\n` +
            `Estado: ${dados.uf}`
        );
    });
</script>
